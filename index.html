<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PkgHub</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
            background: #1C1C1C;
            color: #FFFFFF;
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 40px;
            position: relative;
        }
        
        .menu-toggle {
            position: absolute;
            left: 0;
            top: 0;
            background: #2D2D2D;
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid #404040;
        }
        
        .menu-toggle:hover {
            background: #0078D7;
            transform: scale(1.1);
        }
        
        .menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            display: none;
        }
        
        .menu-overlay.active {
            display: block;
        }
        
        .hamburger-menu {
            position: fixed;
            top: 0;
            left: 0;
            bottom: 0;
            width: 300px;
            background: #2D2D2D;
            z-index: 2001;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            padding: 20px;
            overflow-y: auto;
            border-right: 2px solid #404040;
        }
        
        .hamburger-menu.active {
            transform: translateX(0);
        }
        
        .menu-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #404040;
        }
        
        .menu-title {
            font-size: 24px;
            font-weight: 300;
            color: #0078D7;
        }
        
        .menu-close {
            background: none;
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }
        
        .menu-close:hover {
            background: rgba(255, 255, 255, 0.1);
        }
        
        .menu-section {
            margin-bottom: 25px;
        }
        
        .menu-section-title {
            font-size: 14px;
            color: #888;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            padding-left: 10px;
        }
        
        .menu-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            color: white;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .menu-item:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: #404040;
        }
        
        .menu-item.active {
            background: rgba(0, 120, 215, 0.2);
            color: #0078D7;
            border-color: #0078D7;
        }
        
        .menu-icon {
            margin-right: 15px;
            font-size: 18px;
            width: 24px;
            text-align: center;
        }
        
        .menu-text {
            font-size: 16px;
            flex: 1;
        }
        
        .main-title {
            font-size: 48px;
            font-weight: 300;
            color: #0078D7;
            margin-bottom: 10px;
            letter-spacing: -1px;
        }
        
        .main-title .plus {
            color: #FF4343;
            font-weight: 600;
        }
        
        .subtitle {
            font-size: 18px;
            color: #A0A0A0;
            margin-bottom: 30px;
            font-weight: 300;
        }
        
        .search-section {
            max-width: 600px;
            margin: 0 auto 50px;
        }
        
        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            position: relative;
        }
        
        .metro-input {
            flex: 1;
            background: rgba(255, 255, 255, 0.08);
            border: 2px solid rgba(255, 255, 255, 0.15);
            padding: 16px 24px;
            font-size: 18px;
            color: white;
            transition: all 0.3s;
        }
        
        .metro-input:focus {
            outline: none;
            border-color: #0078D7;
            background: rgba(255, 255, 255, 0.12);
            box-shadow: 0 0 0 3px rgba(0, 120, 215, 0.3);
        }
        
        .metro-input::placeholder {
            color: rgba(255, 255, 255, 0.4);
        }
        
        .metro-btn {
            background: #0078D7;
            color: white;
            border: none;
            padding: 16px 32px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
            min-width: 120px;
        }
        
        .metro-btn:hover {
            background: #106EBE;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 120, 215, 0.4);
        }
        
        .search-hint {
            font-size: 14px;
            color: #666;
            text-align: center;
        }
        
        .suggestions-container {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: #2D2D2D;
            border: 1px solid #404040;
            border-top: none;
            z-index: 1000;
            display: none;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .suggestions-container.show {
            display: block;
        }
        
        .suggestion-item {
            padding: 12px 20px;
            cursor: pointer;
            transition: background 0.2s;
            border-bottom: 1px solid #404040;
        }
        
        .suggestion-item:hover {
            background: rgba(0, 120, 215, 0.2);
        }
        
        .suggestion-item:last-child {
            border-bottom: none;
        }
        
        .suggestion-name {
            font-size: 16px;
            margin-bottom: 4px;
        }
        
        .suggestion-id {
            font-size: 12px;
            color: #888;
            font-family: 'Consolas', monospace;
        }
        
        .search-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 20px;
            justify-content: center;
        }
        
        .search-tag {
            background: rgba(255, 255, 255, 0.1);
            color: #A0A0A0;
            padding: 8px 16px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }
        
        .search-tag:hover {
            background: rgba(0, 120, 215, 0.2);
            color: white;
        }
        
        .tiles-container {
            margin-bottom: 50px;
        }
        
        .section-title {
            font-size: 24px;
            font-weight: 300;
            margin-bottom: 25px;
            color: #E0E0E0;
            text-align: center;
        }
        
        .metro-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 900px) {
            .metro-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 600px) {
            .metro-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .metro-tile {
            background: #2D2D2D;
            padding: 30px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
            position: relative;
            overflow: hidden;
            min-height: 140px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border-top: 4px solid;
        }
        
        .metro-tile:hover {
            background: #3D3D3D;
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }
        
        .tile-browser { border-color: #0078D7; }
        .tile-dev { border-color: #107C10; }
        .tile-chinese { border-color: #FF4343; }
        .tile-media { border-color: #9B4F96; }
        .tile-game { border-color: #FF8C00; }
        .tile-all { border-color: #767676; }
        
        .metro-tile .icon {
            font-size: 36px;
            margin-bottom: 15px;
        }
        
        .metro-tile h3 {
            font-size: 20px;
            font-weight: 400;
            margin-bottom: 8px;
        }
        
        .metro-tile p {
            font-size: 14px;
            color: #A0A0A0;
        }
        
        .apps-section {
            min-height: 400px;
        }
        
        .metro-apps {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .metro-app-card {
            background: #2D2D2D;
            padding: 0;
            overflow: hidden;
            border: none;
            transition: all 0.3s;
            border-top: 4px solid #0078D7;
            cursor: pointer;
        }
        
        .metro-app-card:hover {
            background: #3D3D3D;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        
        .app-card-header {
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            border-bottom: 1px solid #404040;
        }
        
        .app-card-icon {
            width: 48px;
            height: 48px;
            background: #0078D7;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .app-card-title h3 {
            font-size: 18px;
            font-weight: 400;
            margin-bottom: 5px;
        }
        
        .app-card-title .app-id {
            font-size: 12px;
            color: #888;
            font-family: 'Consolas', monospace;
        }
        
        .app-card-content {
            padding: 20px;
        }
        
        .app-meta {
            display: flex;
            justify-content: space-between;
            font-size: 14px;
            color: #888;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #404040;
        }
        
        .metro-install-btn {
            width: 100%;
            padding: 14px;
            background: #0078D7;
            color: white;
            border: none;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .metro-install-btn:hover {
            background: #106EBE;
        }
        
        .metro-install-btn.installing {
            background: #505050;
            cursor: not-allowed;
        }
        
        .metro-install-btn.installed {
            background: #107C10;
            cursor: default;
        }
        
        .metro-install-btn.admin-required {
            background: #FF8C00;
        }
        
        .metro-progress {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #2D2D2D;
            padding: 20px 40px;
            transform: translateY(100%);
            transition: transform 0.3s;
            z-index: 1000;
            border-top: 4px solid #0078D7;
        }
        
        .metro-progress.show {
            transform: translateY(0);
        }
        
        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .progress-bar-container {
            height: 8px;
            background: #404040;
            overflow: hidden;
        }
        
        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #0078D7, #00BCF2);
            width: 0%;
            transition: width 0.3s;
        }
        
        .progress-message {
            margin-top: 10px;
            font-size: 14px;
            color: #A0A0A0;
        }
        
        .metro-empty {
            text-align: center;
            padding: 80px 20px;
            grid-column: 1 / -1;
        }
        
        .metro-empty .icon {
            font-size: 64px;
            color: #444;
            margin-bottom: 20px;
        }
        
        .metro-empty h2 {
            font-size: 28px;
            font-weight: 300;
            margin-bottom: 10px;
            color: #A0A0A0;
        }
        
        .metro-empty p {
            font-size: 16px;
            color: #666;
            max-width: 500px;
            margin: 0 auto 30px;
        }
        
        .metro-footer {
            text-align: center;
            margin-top: 60px;
            padding-top: 30px;
            border-top: 1px solid #333;
            color: #666;
            font-size: 14px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .metro-app-card {
            animation: fadeIn 0.3s ease-out;
        }
        
        .metro-app-card:nth-child(2) { animation-delay: 0.05s; }
        .metro-app-card:nth-child(3) { animation-delay: 0.1s; }
        .metro-app-card:nth-child(4) { animation-delay: 0.15s; }
        .metro-app-card:nth-child(5) { animation-delay: 0.2s; }
        .metro-app-card:nth-child(6) { animation-delay: 0.25s; }
        
        .back-btn {
            background: #444;
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 30px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .back-btn:hover {
            background: #555;
        }
        
        .app-detail-container {
            background: #2D2D2D;
            padding: 40px;
            margin-top: 30px;
            animation: fadeIn 0.4s ease-out;
        }
        
        .detail-header {
            display: flex;
            align-items: center;
            gap: 30px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }
        
        .detail-icon {
            width: 80px;
            height: 80px;
            background: #0078D7;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
        }
        
        .detail-title h1 {
            font-size: 32px;
            font-weight: 300;
            margin-bottom: 8px;
        }
        
        .detail-title .app-id {
            font-size: 16px;
            color: #888;
            font-family: 'Consolas', monospace;
        }
        
        .detail-meta-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
            padding: 30px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid #404040;
        }
        
        .meta-item h4 {
            font-size: 14px;
            color: #888;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .meta-item p {
            font-size: 18px;
            color: white;
        }
        
        .detail-description {
            margin-bottom: 40px;
            line-height: 1.8;
            font-size: 16px;
        }
        
        .detail-description h3 {
            font-size: 20px;
            margin-bottom: 15px;
            color: #E0E0E0;
        }
        
        .detail-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }
        
        .detail-install-btn {
            background: #0078D7;
            color: white;
            border: none;
            padding: 16px 40px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
            flex: 1;
        }
        
        .detail-install-btn:hover {
            background: #106EBE;
        }
        
        .detail-secondary-btn {
            background: #444;
            color: white;
            border: none;
            padding: 16px 30px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
            flex: 1;
        }
        
        .detail-secondary-btn:hover {
            background: #555;
        }
        
        .source-status {
            display: inline-block;
            padding: 4px 8px;
            font-size: 12px;
            margin-left: 8px;
        }
        
        .source-excellent { background: #107C10; color: white; }
        .source-good { background: #0078D7; color: white; }
        .source-medium { background: #FF8C00; color: white; }
        .source-slow { background: #FF4343; color: white; }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .settings-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 30px;
            border-bottom: 1px solid #404040;
            padding-bottom: 0;
        }
        
        .settings-tab {
            background: transparent;
            color: #A0A0A0;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            border-bottom: 3px solid transparent;
        }
        
        .settings-tab:hover {
            color: #FFFFFF;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .settings-tab.active {
            color: #0078D7;
            border-bottom-color: #0078D7;
            background: rgba(0, 120, 215, 0.1);
        }
        
        .settings-content {
            display: none;
            animation: fadeIn 0.3s ease-out;
        }
        
        .settings-content.active {
            display: block;
        }
        
        .settings-section {
            background: #2D2D2D;
            padding: 30px;
            margin-bottom: 25px;
            border: 1px solid #404040;
        }
        
        .section-title {
            font-size: 22px;
            font-weight: 400;
            margin-bottom: 25px;
            color: #E0E0E0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title .icon {
            font-size: 24px;
        }
        
        .settings-group {
            margin-bottom: 25px;
        }
        
        .settings-group:last-child {
            margin-bottom: 0;
        }
        
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            margin-bottom: 15px;
            border: 1px solid transparent;
            transition: all 0.2s;
        }
        
        .setting-item:hover {
            border-color: #404040;
            background: rgba(255, 255, 255, 0.08);
        }
        
        .setting-label {
            flex: 1;
        }
        
        .setting-label h3 {
            font-size: 16px;
            font-weight: 400;
            margin-bottom: 5px;
            color: #FFFFFF;
        }
        
        .setting-label p {
            font-size: 14px;
            color: #888;
            line-height: 1.5;
        }
        
        .setting-control {
            margin-left: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .metro-switch {
            position: relative;
            display: inline-block;
            width: 54px;
            height: 28px;
        }
        
        .metro-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .metro-switch-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #404040;
            transition: .4s;
            border-radius: 0;
        }
        
        .metro-switch-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 0;
        }
        
        input:checked + .metro-switch-slider {
            background-color: #0078D7;
        }
        
        input:checked + .metro-switch-slider:before {
            transform: translateX(26px);
        }
        
        .metro-select {
            background: #404040;
            color: white;
            border: 1px solid #555;
            padding: 10px 15px;
            font-size: 14px;
            min-width: 200px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .metro-select:focus {
            outline: none;
            border-color: #0078D7;
            box-shadow: 0 0 0 2px rgba(0, 120, 215, 0.3);
        }
        
        .metro-input {
            background: #404040;
            color: white;
            border: 1px solid #555;
            padding: 10px 15px;
            font-size: 14px;
            min-width: 200px;
            transition: all 0.2s;
        }
        
        .metro-input:focus {
            outline: none;
            border-color: #0078D7;
            box-shadow: 0 0 0 2px rgba(0, 120, 215, 0.3);
        }
        
        .source-status {
            display: inline-block;
            padding: 4px 8px;
            font-size: 12px;
            border-radius: 3px;
            margin-left: 10px;
            min-width: 60px;
            text-align: center;
        }
        
        .source-excellent { background: #107C10; color: white; }
        .source-good { background: #0078D7; color: white; }
        .source-medium { background: #FF8C00; color: white; }
        .source-slow { background: #FF4343; color: white; }
        .source-unknown { background: #666; color: white; }
        
        .source-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            margin-bottom: 10px;
            border-left: 4px solid;
        }
        
        .source-widget { border-left-color: #0078D7; }
        .source-msstore { border-left-color: #FF4343; }
        
        .source-info {
            flex: 1;
        }
        
        .source-info h4 {
            font-size: 16px;
            margin-bottom: 5px;
            color: #FFFFFF;
        }
        
        .source-info p {
            font-size: 14px;
            color: #888;
        }
        
        .source-actions {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .test-source-btn {
            background: #444;
            color: white;
            border: none;
            padding: 8px 16px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .test-source-btn:hover {
            background: #555;
        }
        
        .test-source-btn.testing {
            background: #0078D7;
            cursor: not-allowed;
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-online { background: #107C10; }
        .status-offline { background: #FF4343; }
        .status-testing { background: #FF8C00; animation: pulse 1s infinite; }
        
        .shortcut-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.05);
            margin-bottom: 8px;
        }
        
        .shortcut-label {
            font-size: 14px;
            color: #E0E0E0;
        }
        
        .shortcut-keys {
            background: #404040;
            padding: 6px 12px;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            font-size: 13px;
            color: #FFFFFF;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 20px;
            text-align: center;
            border: 1px solid #404040;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 300;
            color: #0078D7;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 14px;
            color: #888;
        }
        
        .cache-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .danger-zone {
            border: 2px solid #FF4343;
            background: rgba(255, 67, 67, 0.1);
        }
        
        .danger-zone .section-title {
            color: #FF4343;
        }
        
        .metro-btn.danger {
            background: #FF4343;
        }
        
        .metro-btn.danger:hover {
            background: #E63E3E;
        }
        
        .warning-text {
            color: #FF8C00;
            font-size: 14px;
            margin-top: 10px;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #2D2D2D;
            padding: 15px 20px;
            border-left: 4px solid #0078D7;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            display: none;
            z-index: 1000;
            min-width: 300px;
            animation: slideIn 0.3s ease-out;
        }
        
        .notification.show {
            display: block;
        }
        
        .notification.success { border-left-color: #107C10; }
        .notification.error { border-left-color: #FF4343; }
        .notification.warning { border-left-color: #FF8C00; }
        
        .notification-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }
        
        .notification-title {
            font-size: 16px;
            font-weight: 600;
            color: #FFFFFF;
        }
        
        .notification-close {
            background: none;
            border: none;
            color: #888;
            font-size: 18px;
            cursor: pointer;
            padding: 0;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .notification-message {
            font-size: 14px;
            color: #A0A0A0;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        .settings-footer {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid #404040;
        }
    </style>
</head>
<body>
    <div class="menu-overlay" id="menuOverlay"></div>
    
    <div class="hamburger-menu" id="hamburgerMenu">
        <div class="menu-header">
            <div class="menu-title">PkgHub</div>
            <button class="menu-close" onclick="toggleMenu()">√ó</button>
        </div>
        
        <div class="menu-section">
            <div class="menu-section-title">‰∏ªË¶ÅÂäüËÉΩ</div>
            <div class="menu-item active" onclick="goHome()">
                <div class="menu-icon">üè†</div>
                <div class="menu-text">È¶ñÈ°µ</div>
            </div>
            <div class="menu-item" onclick="openSettings()">
                <div class="menu-icon">‚öôÔ∏è</div>
                <div class="menu-text">ËÆæÁΩÆ</div>
            </div>
        </div>
        
        <div class="menu-section">
            <div class="menu-section-title">Âø´ÈÄüÂàÜÁ±ª</div>
            <div class="menu-item" onclick="browseCategory('popular')">
                <div class="menu-icon">üî•</div>
                <div class="menu-text">ÁÉ≠Èó®Êé®Ëçê</div>
            </div>
            <div class="menu-item" onclick="browseCategory('browser')">
                <div class="menu-icon">üåê</div>
                <div class="menu-text">ÊµèËßàÂô®</div>
            </div>
            <div class="menu-item" onclick="browseCategory('dev')">
                <div class="menu-icon">üíª</div>
                <div class="menu-text">ÂºÄÂèëÂ∑•ÂÖ∑</div>
            </div>
            <div class="menu-item" onclick="browseCategory('chinese')">
                <div class="menu-icon">üá®üá≥</div>
                <div class="menu-text">ÂõΩÂÜÖËΩØ‰ª∂</div>
            </div>
            <div class="menu-item" onclick="browseCategory('media')">
                <div class="menu-icon">üéµ</div>
                <div class="menu-text">Â™í‰ΩìÊí≠Êîæ</div>
            </div>
            <div class="menu-item" onclick="browseCategory('game')">
                <div class="menu-icon">üéÆ</div>
                <div class="menu-text">Ê∏∏Êàè</div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <div class="header">
            <button class="menu-toggle" onclick="toggleMenu()">
                ‚ò∞
            </button>
            <h1 class="main-title">Pkg<span class="plus">Hub</span></h1>
            <p class="subtitle">WinGetÂä†Âº∫ÁâàÔºàÔºü</p>
            
            <div class="search-section">
                <div class="search-box">
                    <input type="text" 
                           class="metro-input" 
                           id="searchInput" 
                           placeholder="ËæìÂÖ•ËΩØ‰ª∂ÂêçÁß∞ÊêúÁ¥¢..."
                           autocomplete="off">
                    <button class="metro-btn" onclick="search()">
                        üîçÊêúÁ¥¢
                    </button>
                    <div class="suggestions-container" id="suggestions"></div>
                </div>
                <div class="search-tags" id="searchTags">
                    <span class="search-tag" onclick="suggestSearch('browser')">ÊµèËßàÂô®</span>
                    <span class="search-tag" onclick="suggestSearch('editor')">ÁºñËæëÂô®</span>
                    <span class="search-tag" onclick="suggestSearch('music')">Èü≥‰πê</span>
                    <span class="search-tag" onclick="suggestSearch('video')">ËßÜÈ¢ë</span>
                    <span class="search-tag" onclick="suggestSearch('game')">Ê∏∏Êàè</span>
                    <span class="search-tag" onclick="suggestSearch('dev')">ÂºÄÂèëÂ∑•ÂÖ∑</span>
                </div>
            </div>
        </div>
        
        <div id="breadcrumb">
        </div>
        
        <div id="content">
        </div>
        
        <div class="metro-footer">
            <p>PkgHub ‚Ä¢ Âü∫‰∫é Electron 19 ‚Ä¢ ÂÖºÂÆπ Windows 7/8/10/11</p>
        </div>
    </div>
    
    <div class="metro-progress" id="progressContainer">
        <div class="progress-header">
            <span id="progressTitle">Ê≠£Âú®ÂÆâË£Ö...</span>
            <span id="progressStatus">0%</span>
        </div>
        <div class="progress-bar-container">
            <div class="progress-bar-fill" id="progressFill"></div>
        </div>
        <div class="progress-message" id="progressMessage"></div>
    </div>
    
    <div class="notification" id="notification">
        <div class="notification-header">
            <span class="notification-title" id="notificationTitle">ÈÄöÁü•Ê†áÈ¢ò</span>
            <button class="notification-close" onclick="hideNotification()">√ó</button>
        </div>
        <div class="notification-message" id="notificationMessage">ÈÄöÁü•ÂÜÖÂÆπ</div>
    </div>
    
    <script>
        let currentCategory = '';
        let installingApps = new Set();
        let currentView = 'home';
        let searchTimeout = null;
        let isPopularAppsLoaded = false;
        
        const defaultPopularApps = [
            { id: 'Microsoft.Edge', name: 'Microsoft Edge', version: 'ÊúÄÊñ∞', source: 'winget' },
            { id: 'Google.Chrome', name: 'Google Chrome', version: 'ÊúÄÊñ∞', source: 'winget' },
            { id: 'Mozilla.Firefox', name: 'Mozilla Firefox', version: 'ÊúÄÊñ∞', source: 'winget' },
            { id: 'Microsoft.VisualStudioCode', name: 'Visual Studio Code', version: 'ÊúÄÊñ∞', source: 'winget' },
            { id: '7zip.7zip', name: '7-Zip', version: 'ÊúÄÊñ∞', source: 'winget' },
            { id: 'VideoLAN.VLC', name: 'VLC Media Player', version: 'ÊúÄÊñ∞', source: 'winget' }
        ];
        
        let appConfig = {};
        let originalConfig = {};
        let currentSettingsTab = 'general';
        
        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('searchInput');
            
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') search();
            });
            
            searchInput.addEventListener('input', (e) => {
                const query = e.target.value.trim();
                if (query.length > 0) {
                    showSearchSuggestions(query);
                } else {
                    hideSearchSuggestions();
                }
            });
            
            searchInput.addEventListener('blur', () => {
                setTimeout(() => hideSearchSuggestions(), 200);
            });
            
            searchInput.addEventListener('focus', () => {
                const query = searchInput.value.trim();
                if (query.length > 0) {
                    showSearchSuggestions(query);
                }
            });
            
            searchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    hideSearchSuggestions();
                    searchInput.value = '';
                } else if (e.key === 'Tab') {
                    hideSearchSuggestions();
                }
            });
            
            window.electronAPI.onInstallProgress((data) => {
                updateInstallProgress(data);
            });
            
            window.electronAPI.onWingetStatus((data) => {
                if (!data.ok) {
                    console.warn('Winget Áä∂ÊÄÅÂºÇÂ∏∏:', data.error);
                }
            });
            
            window.electronAPI.onSettingsUpdate((config) => {
                appConfig = config;
                updateUIFromConfig();
            });
            
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.key === ',') {
                    e.preventDefault();
                    openSettings();
                }
                if (e.ctrlKey && e.key === 'f') {
                    e.preventDefault();
                    document.getElementById('searchInput').focus();
                }
                if (e.ctrlKey && e.key === 'q') {
                    e.preventDefault();
                    window.electronAPI.quitApp();
                }
            });
            
            loadSettings();
            showHomePage();
        });
        
        function toggleMenu() {
            const menu = document.getElementById('hamburgerMenu');
            const overlay = document.getElementById('menuOverlay');
            
            if (menu.classList.contains('active')) {
                menu.classList.remove('active');
                overlay.classList.remove('active');
            } else {
                menu.classList.add('active');
                overlay.classList.add('active');
            }
        }
        
        async function loadSettings() {
            try {
                appConfig = await window.electronAPI.getAppConfig();
                originalConfig = JSON.parse(JSON.stringify(appConfig));
            } catch (error) {
                console.error('Âä†ËΩΩËÆæÁΩÆÂ§±Ë¥•:', error);
                showNotification('error', 'Âä†ËΩΩÂ§±Ë¥•', 'Êó†Ê≥ïÂä†ËΩΩÂ∫îÁî®ËÆæÁΩÆ');
            }
        }
        
        function updateUIFromConfig() {
            const darkModeToggle = document.getElementById('darkModeToggle');
            const searchSuggestionsToggle = document.getElementById('searchSuggestionsToggle');
            const sourceSwitcherToggle = document.getElementById('sourceSwitcherToggle');
            const autoSourceToggle = document.getElementById('autoSourceToggle');
            const batchSizeSelect = document.getElementById('batchSizeSelect');
            const silentInstallToggle = document.getElementById('silentInstallToggle');
            const soundEffectsToggle = document.getElementById('soundEffectsToggle');
            const installNotificationsToggle = document.getElementById('installNotificationsToggle');
            const autoUpdateToggle = document.getElementById('autoUpdateToggle');
            const preloadPopularToggle = document.getElementById('preloadPopularToggle');
            const categoryLimitSelect = document.getElementById('categoryLimitSelect');
            const searchLimitSelect = document.getElementById('searchLimitSelect');
            const defaultSourceSelect = document.getElementById('defaultSourceSelect');
            const msstoreToggle = document.getElementById('msstoreToggle');
            const chinaAutoSwitchToggle = document.getElementById('chinaAutoSwitchToggle');
            const shortcutsEnabledToggle = document.getElementById('shortcutsEnabledToggle');
            const shortcutsSchemeSelect = document.getElementById('shortcutsSchemeSelect');
            const experimentalToggle = document.getElementById('experimentalToggle');
            const verboseLoggingToggle = document.getElementById('verboseLoggingToggle');
            
            if (darkModeToggle) darkModeToggle.checked = appConfig.theme === 'dark';
            if (searchSuggestionsToggle) searchSuggestionsToggle.checked = appConfig.enableSearchSuggestions !== false;
            if (sourceSwitcherToggle) sourceSwitcherToggle.checked = appConfig.showSourceSwitcher !== false;
            if (autoSourceToggle) autoSourceToggle.checked = appConfig.autoSource === true;
            if (batchSizeSelect) batchSizeSelect.value = appConfig.batchSize || 3;
            if (silentInstallToggle) silentInstallToggle.checked = appConfig.silentInstall !== false;
            if (soundEffectsToggle) soundEffectsToggle.checked = appConfig.enableSounds === true;
            if (installNotificationsToggle) installNotificationsToggle.checked = appConfig.installNotifications !== false;
            if (autoUpdateToggle) autoUpdateToggle.checked = appConfig.autoCheckUpdates !== false;
            if (preloadPopularToggle) preloadPopularToggle.checked = true;
            if (categoryLimitSelect) categoryLimitSelect.value = appConfig.categorySearchLimit || 40;
            if (searchLimitSelect) searchLimitSelect.value = 50;
            
            if (defaultSourceSelect) {
                if (appConfig.downloadSource === 'auto' || appConfig.autoSource === true) {
                    defaultSourceSelect.value = 'auto';
                } else {
                    defaultSourceSelect.value = appConfig.downloadSource || 'winget';
                }
            }
            
            if (msstoreToggle) {
                const msstoreSource = appConfig.sources?.find(s => s.id === 'msstore');
                msstoreToggle.checked = msstoreSource ? msstoreSource.enabled : false;
            }
            
            if (chinaAutoSwitchToggle) chinaAutoSwitchToggle.checked = true;
            if (shortcutsEnabledToggle) shortcutsEnabledToggle.checked = true;
            if (shortcutsSchemeSelect) shortcutsSchemeSelect.value = 'default';
            if (experimentalToggle) experimentalToggle.checked = false;
            if (verboseLoggingToggle) verboseLoggingToggle.checked = false;
        }
        
        function openSettings() {
            toggleMenu();
            currentView = 'settings';
            
            const breadcrumb = document.getElementById('breadcrumb');
            breadcrumb.innerHTML = `
                <button class="back-btn" onclick="showHomePage()">‚Üê ËøîÂõûÈ¶ñÈ°µ</button>
            `;
            
            const contentDiv = document.getElementById('content');
            contentDiv.innerHTML = `
                <div class="settings-container">
                    <div class="settings-header">
                        <h1 class="settings-title">PkgHub ËÆæÁΩÆ</h1>
                        <p class="settings-subtitle">Ëá™ÂÆö‰πâ‰Ω†ÁöÑËΩØ‰ª∂ÁÆ°ÁêÜ‰ΩìÈ™å</p>
                    </div>
                    
                    <div class="settings-tabs">
                        <button class="settings-tab active" onclick="showSettingsTab('general')">
                            ‚öôÔ∏è Â∏∏ËßÑËÆæÁΩÆ
                        </button>
                        <button class="settings-tab" onclick="showSettingsTab('sources')">
                            üåê ‰∏ãËΩΩÊ∫ê
                        </button>
                        <button class="settings-tab" onclick="showSettingsTab('shortcuts')">
                            ‚å®Ô∏è Âø´Êç∑ÈîÆ
                        </button>
                        <button class="settings-tab" onclick="showSettingsTab('performance')">
                            üöÄ ÊÄßËÉΩ
                        </button>
                        <button class="settings-tab" onclick="showSettingsTab('about')">
                            ‚ÑπÔ∏è ÂÖ≥‰∫é
                        </button>
                    </div>
                    
                    <div id="generalTab" class="settings-content active">
                        <div class="settings-section">
                            <h2 class="section-title">
                                <span class="icon">üé®</span>
                                Â§ñËßÇ‰∏éÁïåÈù¢
                            </h2>
                            
                            <div class="settings-group">
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <h3>Ê∑±Ëâ≤Ê®°Âºè</h3>
                                        <p>‰ΩøÁî®Ê∑±Ëâ≤ÁïåÈù¢‰∏ªÈ¢òÔºåÈÄÇÂêàÂ§úÈó¥‰ΩøÁî®</p>
                                    </div>
                                    <div class="setting-control">
                                        <label class="metro-switch">
                                            <input type="checkbox" id="darkModeToggle" checked>
                                            <span class="metro-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <h3>ÊòæÁ§∫ÊêúÁ¥¢Âª∫ËÆÆ</h3>
                                        <p>Âú®ÊêúÁ¥¢Êó∂ÊòæÁ§∫ÂÆûÊó∂Âª∫ËÆÆ</p>
                                    </div>
                                    <div class="setting-control">
                                        <label class="metro-switch">
                                            <input type="checkbox" id="searchSuggestionsToggle" checked>
                                            <span class="metro-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <h3>ÊòæÁ§∫‰∏ãËΩΩÊ∫ê</h3>
                                        <p>Âú®Â∫îÁî®Âç°Áâá‰∏äÊòæÁ§∫‰∏ãËΩΩÊ∫êÁä∂ÊÄÅ</p>
                                    </div>
                                    <div class="setting-control">
                                        <label class="metro-switch">
                                            <input type="checkbox" id="sourceSwitcherToggle" checked>
                                            <span class="metro-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h2 class="section-title">
                                <span class="icon">‚ö°</span>
                                ÂÆâË£Ö‰∏é‰∏ãËΩΩ
                            </h2>
                            
                            <div class="settings-group">
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <h3>Ëá™Âä®ÈÄâÊã©ÊúÄÂø´Ê∫ê</h3>
                                        <p>Ê†πÊçÆÊµãÈÄüÁªìÊûúËá™Âä®ÈÄâÊã©ÊúÄ‰Ω≥‰∏ãËΩΩÊ∫ê</p>
                                    </div>
                                    <div class="setting-control">
                                        <label class="metro-switch">
                                            <input type="checkbox" id="autoSourceToggle" checked>
                                            <span class="metro-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <h3>ÊâπÈáèÂÆâË£ÖÊï∞Èáè</h3>
                                        <p>ÂêåÊó∂ÂÆâË£ÖÁöÑÊúÄÂ§ßËΩØ‰ª∂Êï∞Èáè</p>
                                    </div>
                                    <div class="setting-control">
                                        <select class="metro-select" id="batchSizeSelect">
                                            <option value="1">1‰∏™</option>
                                            <option value="2">2‰∏™</option>
                                            <option value="3" selected>3‰∏™</option>
                                            <option value="5">5‰∏™</option>
                                            <option value="10">10‰∏™</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <h3>ÈùôÈªòÂÆâË£Ö</h3>
                                        <p>ÂÆâË£ÖÊó∂‰∏çÊòæÁ§∫Á°ÆËÆ§ÂØπËØùÊ°Ü</p>
                                    </div>
                                    <div class="setting-control">
                                        <label class="metro-switch">
                                            <input type="checkbox" id="silentInstallToggle" checked>
                                            <span class="metro-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h2 class="section-title">
                                <span class="icon">üîî</span>
                                ÈÄöÁü•‰∏éÂ£∞Èü≥
                            </h2>
                            
                            <div class="settings-group">
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <h3>ÂêØÁî®Â£∞Èü≥ÊïàÊûú</h3>
                                        <p>Êìç‰ΩúÊó∂Êí≠ÊîæÈü≥Êïà</p>
                                    </div>
                                    <div class="setting-control">
                                        <label class="metro-switch">
                                            <input type="checkbox" id="soundEffectsToggle">
                                            <span class="metro-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <h3>ÂÆâË£ÖÂÆåÊàêÈÄöÁü•</h3>
                                        <p>ËΩØ‰ª∂ÂÆâË£ÖÂÆåÊàêÂêéÊòæÁ§∫ÈÄöÁü•</p>
                                    </div>
                                    <div class="setting-control">
                                        <label class="metro-switch">
                                            <input type="checkbox" id="installNotificationsToggle" checked>
                                            <span class="metro-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <h3>Ëá™Âä®Ê£ÄÊü•Êõ¥Êñ∞</h3>
                                        <p>ÂêØÂä®Êó∂Ëá™Âä®Ê£ÄÊü•Â∫îÁî®Êõ¥Êñ∞</p>
                                    </div>
                                    <div class="setting-control">
                                        <label class="metro-switch">
                                            <input type="checkbox" id="autoUpdateToggle" checked>
                                            <span class="metro-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="sourcesTab" class="settings-content">
                        <div class="settings-section">
                            <h2 class="section-title">
                                <span class="icon">üì¶</span>
                                ËΩØ‰ª∂Ê∫êÁÆ°ÁêÜ
                            </h2>
                            
                            <div class="setting-item">
                                <div class="setting-label">
                                    <h3>ÈªòËÆ§‰∏ãËΩΩÊ∫ê</h3>
                                    <p>‰ºòÂÖà‰ΩøÁî®ÁöÑËΩØ‰ª∂‰∏ãËΩΩÊ∫ê</p>
                                </div>
                                <div class="setting-control">
                                    <select class="metro-select" id="defaultSourceSelect">
                                        <option value="winget">Windows Package Manager</option>
                                        <option value="msstore">ÂæÆËΩØÂïÜÂ∫ó (ÂõΩÂÜÖCDNÂä†ÈÄü)</option>
                                        <option value="auto">Ëá™Âä®ÈÄâÊã©ÊúÄÂø´</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div id="sourcesList" class="settings-group">
                                <div class="source-item source-widget">
                                    <div class="source-info">
                                        <h4>
                                            <span class="status-indicator status-online"></span>
                                            Windows Package Manager
                                            <span class="source-status source-excellent">ÊûÅÂø´</span>
                                        </h4>
                                        <p>ÂæÆËΩØÂÆòÊñπËΩØ‰ª∂Ê∫êÔºåÂåÖÂê´ÁªùÂ§ßÂ§öÊï∞Â∏∏Áî®ËΩØ‰ª∂</p>
                                    </div>
                                    <div class="source-actions">
                                        <button class="test-source-btn" onclick="testSource('winget', this)">
                                            ÊµãÈÄü
                                        </button>
                                        <label class="metro-switch">
                                            <input type="checkbox" checked disabled>
                                            <span class="metro-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="source-item source-msstore">
                                    <div class="source-info">
                                        <h4>
                                            <span class="status-indicator status-online"></span>
                                            ÂæÆËΩØÂïÜÂ∫óÊ∫ê
                                            <span class="source-status source-good">Âø´ÈÄü</span>
                                        </h4>
                                        <p>ÂõΩÂÜÖCDNÂä†ÈÄüÔºåÈÄÇÂêà‰∏ãËΩΩÂõΩÂÜÖËΩØ‰ª∂Â¶ÇÂæÆ‰ø°„ÄÅQQÁ≠â</p>
                                    </div>
                                    <div class="source-actions">
                                        <button class="test-source-btn" onclick="testSource('msstore', this)">
                                            ÊµãÈÄü
                                        </button>
                                        <label class="metro-switch">
                                            <input type="checkbox" id="msstoreToggle">
                                            <span class="metro-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">
                                    <h3>ÂõΩÂÜÖËΩØ‰ª∂Ëá™Âä®ÂàáÊç¢</h3>
                                    <p>Ê£ÄÊµãÂà∞ÂõΩÂÜÖËΩØ‰ª∂Êó∂Ëá™Âä®‰ΩøÁî®ÂæÆËΩØÂïÜÂ∫óÊ∫ê</p>
                                </div>
                                <div class="setting-control">
                                    <label class="metro-switch">
                                        <input type="checkbox" id="chinaAutoSwitchToggle" checked>
                                        <span class="metro-switch-slider"></span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h2 class="section-title">
                                <span class="icon">üìä</span>
                                Ê∫êÁä∂ÊÄÅÁõëÊéß
                            </h2>
                            
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-value" id="wingetSpeed">156ms</div>
                                    <div class="stat-label">WingetÂìçÂ∫îÊó∂Èó¥</div>
                                </div>
                                
                                <div class="stat-card">
                                    <div class="stat-value" id="msstoreSpeed">432ms</div>
                                    <div class="stat-label">ÂæÆËΩØÂïÜÂ∫óÂìçÂ∫îÊó∂Èó¥</div>
                                </div>
                                
                                <div class="stat-card">
                                    <div class="stat-value" id="lastTestTime">5ÂàÜÈíüÂâç</div>
                                    <div class="stat-label">ÊúÄÂêéÊµãÈÄüÊó∂Èó¥</div>
                                </div>
                            </div>
                            
                            <div class="cache-actions">
                                <button class="metro-btn secondary" onclick="testAllSources()">
                                    ÂÖ®ÈÉ®ÊµãÈÄü
                                </button>
                                <button class="metro-btn" onclick="optimizeSources()">
                                    ‰ºòÂåñËÆæÁΩÆ
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div id="shortcutsTab" class="settings-content">
                        <div class="settings-section">
                            <h2 class="section-title">
                                <span class="icon">‚å®Ô∏è</span>
                                ÈîÆÁõòÂø´Êç∑ÈîÆ
                            </h2>
                            
                            <div class="settings-group">
                                <div class="shortcut-item">
                                    <div class="shortcut-label">ÊêúÁ¥¢ËΩØ‰ª∂</div>
                                    <div class="shortcut-keys">Ctrl + F</div>
                                </div>
                                
                                <div class="shortcut-item">
                                    <div class="shortcut-label">ÂÆâË£ÖÈÄâ‰∏≠ËΩØ‰ª∂</div>
                                    <div class="shortcut-keys">Ctrl + I</div>
                                </div>
                                
                                <div class="shortcut-item">
                                    <div class="shortcut-label">ÊâìÂºÄËÆæÁΩÆ</div>
                                    <div class="shortcut-keys">Ctrl + ,</div>
                                </div>
                                
                                <div class="shortcut-item">
                                    <div class="shortcut-label">ËøîÂõûÈ¶ñÈ°µ</div>
                                    <div class="shortcut-keys">Esc</div>
                                </div>
                                
                                <div class="shortcut-item">
                                    <div class="shortcut-label">Âà∑Êñ∞È°µÈù¢</div>
                                    <div class="shortcut-keys">F5</div>
                                </div>
                                
                                <div class="shortcut-item">
                                    <div class="shortcut-label">ÂºÄÂèëËÄÖÂ∑•ÂÖ∑</div>
                                    <div class="shortcut-keys">F12</div>
                                </div>
                                
                                <div class="shortcut-item">
                                    <div class="shortcut-label">ÈÄÄÂá∫Â∫îÁî®</div>
                                    <div class="shortcut-keys">Ctrl + Q</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h2 class="section-title">
                                <span class="icon">üéÆ</span>
                                Ëá™ÂÆö‰πâÂø´Êç∑ÈîÆ
                            </h2>
                            
                            <div class="setting-item">
                                <div class="setting-label">
                                    <h3>ÂêØÁî®Âø´Êç∑ÈîÆ</h3>
                                    <p>ÂêØÁî®ÂÖ®Â±ÄÈîÆÁõòÂø´Êç∑ÈîÆ</p>
                                </div>
                                <div class="setting-control">
                                    <label class="metro-switch">
                                        <input type="checkbox" id="shortcutsEnabledToggle" checked>
                                        <span class="metro-switch-slider"></span>
                                    </label>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">
                                    <h3>Âø´Êç∑ÈîÆÊñπÊ°à</h3>
                                    <p>ÈÄâÊã©Âø´Êç∑ÈîÆÈÖçÁΩÆÊñπÊ°à</p>
                                </div>
                                <div class="setting-control">
                                    <select class="metro-select" id="shortcutsSchemeSelect">
                                        <option value="default" selected>ÈªòËÆ§ÊñπÊ°à</option>
                                        <option value="vscode">VS CodeÈ£éÊ†º</option>
                                        <option value="windows">WindowsÊ†áÂáÜ</option>
                                        <option value="custom">Ëá™ÂÆö‰πâ</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="performanceTab" class="settings-content">
                        <div class="settings-section">
                            <h2 class="section-title">
                                <span class="icon">üíæ</span>
                                ÁºìÂ≠òÁÆ°ÁêÜ
                            </h2>
                            
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-value" id="searchCacheCount">128</div>
                                    <div class="stat-label">ÊêúÁ¥¢ÁºìÂ≠òÈ°π</div>
                                </div>
                                
                                <div class="stat-card">
                                    <div class="stat-value" id="categoryCacheCount">6</div>
                                    <div class="stat-label">ÂàÜÁ±ªÁºìÂ≠ò</div>
                                </div>
                                
                                <div class="stat-card">
                                    <div class="stat-value" id="cacheSize">2.4MB</div>
                                    <div class="stat-label">ÁºìÂ≠òÂ§ßÂ∞è</div>
                                </div>
                            </div>
                            
                            <div class="cache-actions">
                                <button class="metro-btn secondary" onclick="clearSearchCache()">
                                    Ê∏ÖÈô§ÊêúÁ¥¢ÁºìÂ≠ò
                                </button>
                                <button class="metro-btn secondary" onclick="clearCategoryCache()">
                                    Ê∏ÖÈô§ÂàÜÁ±ªÁºìÂ≠ò
                                </button>
                                <button class="metro-btn" onclick="clearAllCache()">
                                    Ê∏ÖÈô§ÊâÄÊúâÁºìÂ≠ò
                                </button>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h2 class="section-title">
                                <span class="icon">‚ö°</span>
                                ÊÄßËÉΩ‰ºòÂåñ
                            </h2>
                            
                            <div class="settings-group">
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <h3>È¢ÑÂä†ËΩΩÁÉ≠Èó®Â∫îÁî®</h3>
                                        <p>ÂêØÂä®Êó∂È¢ÑÂä†ËΩΩÁÉ≠Èó®Êé®ËçêÂàóË°®</p>
                                    </div>
                                    <div class="setting-control">
                                        <label class="metro-switch">
                                            <input type="checkbox" id="preloadPopularToggle" checked>
                                            <span class="metro-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <h3>ÂàÜÁ±ªÊêúÁ¥¢ÈôêÂà∂</h3>
                                        <p>ÊØè‰∏™ÂàÜÁ±ªÊòæÁ§∫ÁöÑÊúÄÂ§ßÂ∫îÁî®Êï∞Èáè</p>
                                    </div>
                                    <div class="setting-control">
                                        <select class="metro-select" id="categoryLimitSelect">
                                            <option value="20">20‰∏™</option>
                                            <option value="30" selected>30‰∏™</option>
                                            <option value="40">40‰∏™</option>
                                            <option value="50">50‰∏™</option>
                                            <option value="100">100‰∏™</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <h3>ÊêúÁ¥¢ÁªìÊûúÈôêÂà∂</h3>
                                        <p>ÊØèÊ¨°ÊêúÁ¥¢ÊòæÁ§∫ÁöÑÊúÄÂ§ßÁªìÊûúÊï∞Èáè</p>
                                    </div>
                                    <div class="setting-control">
                                        <select class="metro-select" id="searchLimitSelect">
                                            <option value="20">20‰∏™</option>
                                            <option value="30">30‰∏™</option>
                                            <option value="50" selected>50‰∏™</option>
                                            <option value="100">100‰∏™</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="settings-section danger-zone">
                            <h2 class="section-title">
                                <span class="icon">‚ö†Ô∏è</span>
                                È´òÁ∫ßËÆæÁΩÆ
                            </h2>
                            
                            <div class="settings-group">
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <h3>ÂÆûÈ™åÊÄßÂäüËÉΩ</h3>
                                        <p>ÂêØÁî®Ê≠£Âú®ÂºÄÂèëÁöÑÊñ∞ÂäüËÉΩÔºàÂèØËÉΩ‰∏çÁ®≥ÂÆöÔºâÔºàËøòÊ≤°ÂÅöÂë¢ËøôÁé©ÊÑèÔºâ</p>
                                    </div>
                                    <div class="setting-control">
                                        <label class="metro-switch">
                                            <input type="checkbox" id="experimentalToggle">
                                            <span class="metro-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="setting-item">
                                    <div class="setting-label">
                                        <h3>ËØ¶ÁªÜÊó•ÂøóËÆ∞ÂΩï</h3>
                                        <p>ËÆ∞ÂΩïËØ¶ÁªÜÁöÑÊìç‰ΩúÊó•ÂøóÔºàÂΩ±ÂìçÊÄßËÉΩÔºâÔºàËøôÁé©ÊÑèÊàë‰πüÊ≤°ÂÅöÔºâ</p>
                                    </div>
                                    <div class="setting-control">
                                        <label class="metro-switch">
                                            <input type="checkbox" id="verboseLoggingToggle">
                                            <span class="metro-switch-slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="cache-actions">
                                <button class="metro-btn danger" onclick="resetToDefaults()">
                                    ÊÅ¢Â§çÈªòËÆ§ËÆæÁΩÆ
                                </button>
                                <button class="metro-btn secondary" onclick="exportSettings()">
                                    ÂØºÂá∫ËÆæÁΩÆ
                                </button>
                                <button class="metro-btn secondary" onclick="importSettings()">
                                    ÂØºÂÖ•ËÆæÁΩÆ
                                </button>
                            </div>
                            
                            <p class="warning-text">‚ö†Ô∏è ÊÅ¢Â§çÈªòËÆ§ËÆæÁΩÆÂ∞ÜÊ∏ÖÈô§ÊâÄÊúâËá™ÂÆö‰πâÈÖçÁΩÆ</p>
                        </div>
                    </div>
                    
                    <div id="aboutTab" class="settings-content">
                        <div class="settings-section">
                            <h2 class="section-title">
                                <span class="icon">‚ÑπÔ∏è</span>
                                ÂÖ≥‰∫é PkgHub
                            </h2>
                            
                            <div class="setting-item">
                                <div class="setting-label">
                                    <h3>ÁâàÊú¨‰ø°ÊÅØ</h3>
                                    <p>
                                        <strong>ÂΩìÂâçÁâàÊú¨Ôºö</strong> <span id="appVersion">1.0.1</span><br>
                                        <strong>ElectronÔºö</strong> <span id="electronVersion">19.1.9</span><br>
                                        <strong>ÊûÑÂª∫Êó•ÊúüÔºö</strong> <span id="buildDate">2026-02-09</span>
                                    </p>
                                </div>
                                <div class="setting-control">
                                    <button class="metro-btn" onclick="checkForUpdates()">
                                        Ê£ÄÊü•Êõ¥Êñ∞
                                    </button>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">
                                    <h3>Á≥ªÁªü‰ø°ÊÅØ</h3>
                                    <p>
                                        <strong>Êìç‰ΩúÁ≥ªÁªüÔºö</strong> <span id="osInfo">Windows</span><br>
                                        <strong>Winget ÁâàÊú¨Ôºö</strong> <span id="wingetVersion">Êú™Áü•</span><br>
                                        <strong>Á°¨‰ª∂Êû∂ÊûÑÔºö</strong> <span id="architecture">x64</span>
                                    </p>
                                </div>
                                <div class="setting-control">
                                    <button class="metro-btn secondary" onclick="copySystemInfo()">
                                        Â§çÂà∂‰ø°ÊÅØ
                                    </button>
                                </div>
                            </div>
                            
                            <div class="setting-item">
                                <div class="setting-label">
                                    <h3>‰ΩøÁî®ÁªüËÆ°</h3>
                                    <p>
                                        <strong>Â∑≤ÂÆâË£ÖËΩØ‰ª∂Ôºö</strong> <span id="installedCount">Êú™Áü•</span> ‰∏™<br>
                                        <strong>ÊêúÁ¥¢Ê¨°Êï∞Ôºö</strong> <span id="searchCount">Êú™Áü•</span> Ê¨°<br>
                                        <strong>ËøêË°åÊó∂Èó¥Ôºö</strong> <span id="uptime">Êú™Áü•ÔºàÂ•ΩÂêßÂÖ∂ÂÆûÊòØÊáíÂæóÁªüËÆ°‰∫ÜÔºâ</span>
                                    </p>
                                </div>
                                <div class="setting-control">
                                    <button class="metro-btn secondary" onclick="resetStatistics()">
                                        ÈáçÁΩÆÁªüËÆ°
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="settings-section">
                            <h2 class="section-title">
                                <span class="icon">üîó</span>
                                ÈìæÊé•‰∏éÊîØÊåÅ
                            </h2>
                            
                            <div class="settings-group" style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                                <button class="metro-btn secondary" onclick="openLink('github')">
                                    GitHub ‰ªìÂ∫ì
                                </button>
                                <button class="metro-btn secondary" onclick="openLink('issues')">
                                    Êä•ÂëäÈóÆÈ¢ò
                                </button>
                                <button class="metro-btn secondary" onclick="openLink('docs')">
                                    ‰ΩøÁî®ÊñáÊ°£
                                </button>
                                <button class="metro-btn secondary" onclick="openLink('feedback')">
                                    ÊÑèËßÅÂèçÈ¶à
                                </button>
                            </div>
                            
                            <div class="setting-item" style="margin-top: 20px;">
                                <div class="setting-label">
                                    <h3>ÂºÄÊ∫êÂçèËÆÆ</h3>
                                    <p>PkgHub Âü∫‰∫é MIT ÂçèËÆÆÂºÄÊ∫êÔºåÊ¨¢ËøéË¥°ÁåÆ‰ª£Á†ÅÂíåÂèçÈ¶àÂª∫ËÆÆ„ÄÇ</p>
                                </div>
                                <div class="setting-control">
                                    <button class="metro-btn secondary" onclick="showLicense()">
                                        Êü•ÁúãÂçèËÆÆ
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="settings-footer">
                        <button class="metro-btn secondary" onclick="cancelSettings()">
                            ÂèñÊ∂à
                        </button>
                        <button class="metro-btn" onclick="saveSettings()">
                            ‰øùÂ≠òËÆæÁΩÆ
                        </button>
                    </div>
                </div>
            `;
            
            updateUIFromConfig();
            showSettingsTab('general');
            updateSettingsStats();
        }
        
        function showSettingsTab(tabId) {
            currentSettingsTab = tabId;
            
            document.querySelectorAll('.settings-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('.settings-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const activeTab = document.querySelector(`.settings-tab[onclick*="${tabId}"]`);
            if (activeTab) {
                activeTab.classList.add('active');
            }
            
            const activeContent = document.getElementById(`${tabId}Tab`);
            if (activeContent) {
                activeContent.classList.add('active');
            }
        }
        
        async function updateSettingsStats() {
            try {
                const stats = await window.electronAPI.getAppStats();
                
                const searchCacheCount = document.getElementById('searchCacheCount');
                const categoryCacheCount = document.getElementById('categoryCacheCount');
                const cacheSize = document.getElementById('cacheSize');
                const installedCount = document.getElementById('installedCount');
                const searchCount = document.getElementById('searchCount');
                const uptime = document.getElementById('uptime');
                
                if (searchCacheCount) searchCacheCount.textContent = stats.searchCacheCount || 0;
                if (categoryCacheCount) categoryCacheCount.textContent = stats.categoryCacheCount || 0;
                if (cacheSize) cacheSize.textContent = stats.cacheSize || '0KB';
                if (installedCount) installedCount.textContent = stats.installedCount || 0;
                if (searchCount) searchCount.textContent = stats.searchCount || 0;
                if (uptime) uptime.textContent = stats.uptime || '0Â∞èÊó∂';
                
                const appVersion = await window.electronAPI.getAppVersion();
                const appVersionElement = document.getElementById('appVersion');
                const electronVersionElement = document.getElementById('electronVersion');
                
                if (appVersionElement) appVersionElement.textContent = appVersion.version || '0.1.0';
                if (electronVersionElement) electronVersionElement.textContent = appVersion.electron || '19.1.9';
                
                const systemInfo = await window.electronAPI.getSystemInfo();
                const osInfoElement = document.getElementById('osInfo');
                const architectureElement = document.getElementById('architecture');
                
                if (osInfoElement) osInfoElement.textContent = systemInfo.platform || 'Windows';
                if (architectureElement) architectureElement.textContent = systemInfo.arch || 'x64';
                
                const wingetInfo = await window.electronAPI.getWingetInfo();
                const wingetVersionElement = document.getElementById('wingetVersion');
                if (wingetVersionElement) wingetVersionElement.textContent = wingetInfo.version || 'Êú™Áü•';
                
            } catch (error) {
                console.error('Êõ¥Êñ∞ÁªüËÆ°‰ø°ÊÅØÂ§±Ë¥•:', error);
            }
        }
        
        async function testSource(sourceId, button) {
            const originalText = button.textContent;
            button.classList.add('testing');
            button.textContent = 'ÊµãÈÄü‰∏≠...';
            button.disabled = true;
            
            try {
                const result = await window.electronAPI.testSourceSpeed(sourceId);
                
                if (result.success) {
                    const rating = result.rating || { level: 'unknown', text: 'Êú™Áü•' };
                    const statusElement = document.querySelector(`.source-item.source-${sourceId} .source-status`);
                    
                    if (statusElement) {
                        statusElement.className = 'source-status source-' + rating.level;
                        statusElement.textContent = rating.text;
                    }
                    
                    const indicator = document.querySelector(`.source-item.source-${sourceId} .status-indicator`);
                    if (indicator) {
                        indicator.className = 'status-indicator status-online';
                    }
                    
                    updateSourceStats(sourceId, result.speed);
                    showNotification('success', 'ÊµãÈÄüÊàêÂäü', `${sourceId} Ê∫êÂìçÂ∫îÊó∂Èó¥: ${result.speed}ms`);
                } else {
                    showNotification('error', 'ÊµãÈÄüÂ§±Ë¥•', result.error || 'Êó†Ê≥ïËøûÊé•Âà∞ËØ•ËΩØ‰ª∂Ê∫ê');
                    
                    const indicator = document.querySelector(`.source-item.source-${sourceId} .status-indicator`);
                    if (indicator) {
                        indicator.className = 'status-indicator status-offline';
                    }
                }
            } catch (error) {
                console.error('ÊµãÈÄüÂ§±Ë¥•:', error);
                showNotification('error', 'ÊµãÈÄüÂ§±Ë¥•', 'ÊµãÈÄüËøáÁ®ã‰∏≠Âá∫Áé∞ÈîôËØØ');
            } finally {
                button.classList.remove('testing');
                button.textContent = originalText;
                button.disabled = false;
            }
        }
        
        async function testAllSources() {
            const buttons = document.querySelectorAll('.test-source-btn');
            for (const button of buttons) {
                const sourceId = button.getAttribute('onclick').match(/'([^']+)'/)[1];
                await testSource(sourceId, button);
                await new Promise(resolve => setTimeout(resolve, 1000));
            }
        }
        
        function optimizeSources() {
            const fastestSource = getFastestSource();
            
            if (fastestSource) {
                const defaultSourceSelect = document.getElementById('defaultSourceSelect');
                if (defaultSourceSelect) {
                    defaultSourceSelect.value = fastestSource.id;
                    showNotification('success', '‰ºòÂåñÂÆåÊàê', `Â∑≤ËÆæÁΩÆ ${fastestSource.name} ‰∏∫ÈªòËÆ§‰∏ãËΩΩÊ∫ê`);
                }
            } else {
                showNotification('info', '‰ºòÂåñÂÆåÊàê', 'Â∑≤Ê†πÊçÆÊµãÈÄüÁªìÊûú‰ºòÂåñÊ∫êËÆæÁΩÆ');
            }
        }
        
        function getFastestSource() {
            const wingetSpeedElement = document.getElementById('wingetSpeed');
            const msstoreSpeedElement = document.getElementById('msstoreSpeed');
            
            if (!wingetSpeedElement || !msstoreSpeedElement) return null;
            
            const wingetSpeed = parseInt(wingetSpeedElement.textContent) || 9999;
            const msstoreSpeed = parseInt(msstoreSpeedElement.textContent) || 9999;
            
            if (wingetSpeed <= msstoreSpeed) {
                return { id: 'winget', name: 'Windows Package Manager' };
            } else {
                return { id: 'msstore', name: 'ÂæÆËΩØÂïÜÂ∫óÊ∫ê' };
            }
        }
        
        function updateSourceStats(sourceId, speed) {
            if (sourceId === 'winget') {
                const wingetSpeedElement = document.getElementById('wingetSpeed');
                if (wingetSpeedElement) wingetSpeedElement.textContent = speed + 'ms';
            } else if (sourceId === 'msstore') {
                const msstoreSpeedElement = document.getElementById('msstoreSpeed');
                if (msstoreSpeedElement) msstoreSpeedElement.textContent = speed + 'ms';
            }
            
            const lastTestTimeElement = document.getElementById('lastTestTime');
            if (lastTestTimeElement) lastTestTimeElement.textContent = 'ÂàöÂàö';
        }
        
        async function clearSearchCache() {
            try {
                await window.electronAPI.clearCache('search');
                showNotification('success', 'ÁºìÂ≠òÊ∏ÖÁêÜ', 'ÊêúÁ¥¢ÁºìÂ≠òÂ∑≤Ê∏ÖÈô§');
                updateSettingsStats();
            } catch (error) {
                showNotification('error', 'Ê∏ÖÁêÜÂ§±Ë¥•', 'Ê∏ÖÈô§ÊêúÁ¥¢ÁºìÂ≠òÊó∂Âá∫Èîô');
            }
        }
        
        async function clearCategoryCache() {
            try {
                await window.electronAPI.clearCache('category');
                showNotification('success', 'ÁºìÂ≠òÊ∏ÖÁêÜ', 'ÂàÜÁ±ªÁºìÂ≠òÂ∑≤Ê∏ÖÈô§');
                updateSettingsStats();
            } catch (error) {
                showNotification('error', 'Ê∏ÖÁêÜÂ§±Ë¥•', 'Ê∏ÖÈô§ÂàÜÁ±ªÁºìÂ≠òÊó∂Âá∫Èîô');
            }
        }
        
        async function clearAllCache() {
            try {
                await window.electronAPI.clearCache('all');
                showNotification('success', 'ÁºìÂ≠òÊ∏ÖÁêÜ', 'ÊâÄÊúâÁºìÂ≠òÂ∑≤Ê∏ÖÈô§');
                updateSettingsStats();
            } catch (error) {
                showNotification('error', 'Ê∏ÖÁêÜÂ§±Ë¥•', 'Ê∏ÖÈô§ÁºìÂ≠òÊó∂Âá∫Èîô');
            }
        }
        
        function resetToDefaults() {
            if (confirm('Á°ÆÂÆöË¶ÅÊÅ¢Â§çÊâÄÊúâÈªòËÆ§ËÆæÁΩÆÂêóÔºüÊ≠§Êìç‰ΩúÊó†Ê≥ïÊí§ÈîÄ„ÄÇ')) {
                window.electronAPI.resetSettings()
                    .then(() => {
                        showNotification('success', 'ÈáçÁΩÆÊàêÂäü', 'ËÆæÁΩÆÂ∑≤ÊÅ¢Â§ç‰∏∫ÈªòËÆ§ÂÄº');
                        setTimeout(() => {
                            loadSettings();
                            updateUIFromConfig();
                        }, 1000);
                    })
                    .catch(error => {
                        showNotification('error', 'ÈáçÁΩÆÂ§±Ë¥•', error.message);
                    });
            }
        }
        
        function exportSettings() {
            window.electronAPI.exportSettings()
                .then(result => {
                    if (result.success) {
                        showNotification('success', 'ÂØºÂá∫ÊàêÂäü', 'ËÆæÁΩÆÂ∑≤ÂØºÂá∫Âà∞Êñá‰ª∂');
                    } else {
                        showNotification('error', 'ÂØºÂá∫Â§±Ë¥•', result.error);
                    }
                })
                .catch(error => {
                    showNotification('error', 'ÂØºÂá∫Â§±Ë¥•', error.message);
                });
        }
        
        function importSettings() {
            window.electronAPI.importSettings()
                .then(result => {
                    if (result.success) {
                        showNotification('success', 'ÂØºÂÖ•ÊàêÂäü', 'ËÆæÁΩÆÂ∑≤‰ªéÊñá‰ª∂ÂØºÂÖ•');
                        setTimeout(() => {
                            loadSettings();
                            updateUIFromConfig();
                        }, 1000);
                    } else {
                        showNotification('error', 'ÂØºÂÖ•Â§±Ë¥•', result.error);
                    }
                })
                .catch(error => {
                    showNotification('error', 'ÂØºÂÖ•Â§±Ë¥•', error.message);
                });
        }
        
        function checkForUpdates() {
            window.electronAPI.checkForUpdates()
                .then(result => {
                    if (result.updateAvailable) {
                        showNotification('success', 'Êõ¥Êñ∞ÂèØÁî®', `ÂèëÁé∞Êñ∞ÁâàÊú¨ ${result.latestVersion}`);
                    } else {
                        showNotification('info', 'Ê£ÄÊü•ÂÆåÊàê', 'ÂΩìÂâçÂ∑≤ÊòØÊúÄÊñ∞ÁâàÊú¨');
                    }
                })
                .catch(error => {
                    showNotification('error', 'Ê£ÄÊü•Â§±Ë¥•', 'Êó†Ê≥ïÊ£ÄÊü•Êõ¥Êñ∞Ôºö' + error.message);
                });
        }
        
        function copySystemInfo() {
            const osInfoElement = document.getElementById('osInfo');
            const wingetVersionElement = document.getElementById('wingetVersion');
            const architectureElement = document.getElementById('architecture');
            const appVersionElement = document.getElementById('appVersion');
            
            if (!osInfoElement || !wingetVersionElement || !architectureElement || !appVersionElement) return;
            
            const os = osInfoElement.textContent;
            const winget = wingetVersionElement.textContent;
            const arch = architectureElement.textContent;
            const version = appVersionElement.textContent;
            
            const text = `PkgHub ${version}\nÊìç‰ΩúÁ≥ªÁªü: ${os}\nWingetÁâàÊú¨: ${winget}\nÊû∂ÊûÑ: ${arch}`;
            
            navigator.clipboard.writeText(text)
                .then(() => {
                    showNotification('success', 'Â§çÂà∂ÊàêÂäü', 'Á≥ªÁªü‰ø°ÊÅØÂ∑≤Â§çÂà∂Âà∞Ââ™Ë¥¥Êùø');
                })
                .catch(() => {
                    showNotification('error', 'Â§çÂà∂Â§±Ë¥•', 'Êó†Ê≥ïÂ§çÂà∂Âà∞Ââ™Ë¥¥Êùø');
                });
        }
        
        function resetStatistics() {
            if (confirm('Á°ÆÂÆöË¶ÅÈáçÁΩÆ‰ΩøÁî®ÁªüËÆ°ÂêóÔºüÊ≠§Êìç‰ΩúÊó†Ê≥ïÊí§ÈîÄ„ÄÇ')) {
                window.electronAPI.resetStatistics()
                    .then(() => {
                        showNotification('success', 'ÈáçÁΩÆÊàêÂäü', '‰ΩøÁî®ÁªüËÆ°Â∑≤ÈáçÁΩÆ');
                        updateSettingsStats();
                    })
                    .catch(error => {
                        showNotification('error', 'ÈáçÁΩÆÂ§±Ë¥•', error.message);
                    });
            }
        }
        
        function openLink(type) {
            const urls = {
                github: 'https://github.com/Maresoft365/pkg-hub',
                issues: 'https://github.com/Maresoft365/pkg-hub/issues',
                docs: 'https://github.com/Maresoft365/pkg-hub/wiki',
                feedback: 'https://github.com/Maresoft365/pkg-hub/discussions'
            };
            
            if (urls[type]) {
                window.electronAPI.openExternal(urls[type]);
            }
        }
        
        function showLicense() {
            window.electronAPI.showLicense();
        }
        
        function showNotification(type, title, message) {
            const notification = document.getElementById('notification');
            const titleElement = document.getElementById('notificationTitle');
            const messageElement = document.getElementById('notificationMessage');
            
            notification.className = 'notification ' + type;
            titleElement.textContent = title;
            messageElement.textContent = message;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                hideNotification();
            }, 5000);
        }
        
        function hideNotification() {
            const notification = document.getElementById('notification');
            if (notification) {
                notification.classList.remove('show');
            }
        }
        
        function cancelSettings() {
            if (hasSettingsChanges()) {
                if (confirm('ÊúâÊú™‰øùÂ≠òÁöÑÊõ¥ÊîπÔºåÁ°ÆÂÆöË¶ÅÂèñÊ∂àÂêóÔºü')) {
                    showHomePage();
                }
            } else {
                showHomePage();
            }
        }
        
        async function saveSettings() {
            const msstoreEnabled = document.getElementById('msstoreToggle').checked;
            
            const newConfig = {
                theme: document.getElementById('darkModeToggle').checked ? 'dark' : 'light',
                enableSearchSuggestions: document.getElementById('searchSuggestionsToggle').checked,
                showSourceSwitcher: document.getElementById('sourceSwitcherToggle').checked,
                downloadSource: document.getElementById('autoSourceToggle').checked ? 'auto' : document.getElementById('defaultSourceSelect').value,
                batchSize: parseInt(document.getElementById('batchSizeSelect').value),
                silentInstall: document.getElementById('silentInstallToggle').checked,
                enableSounds: document.getElementById('soundEffectsToggle').checked,
                installNotifications: document.getElementById('installNotificationsToggle').checked,
                autoCheckUpdates: document.getElementById('autoUpdateToggle').checked,
                categorySearchLimit: parseInt(document.getElementById('categoryLimitSelect').value),
                msstoreEnabled: msstoreEnabled,
                autoSource: document.getElementById('autoSourceToggle').checked
            };
            
            try {
                await window.electronAPI.updateAppConfig(newConfig);
                showNotification('success', '‰øùÂ≠òÊàêÂäü', 'ËÆæÁΩÆÂ∑≤‰øùÂ≠ò');
                
                originalConfig = JSON.parse(JSON.stringify(appConfig));
                
                setTimeout(() => {
                    showHomePage();
                }, 1000);
            } catch (error) {
                showNotification('error', '‰øùÂ≠òÂ§±Ë¥•', error.message);
            }
        }
        
        function hasSettingsChanges() {
            const msstoreEnabled = document.getElementById('msstoreToggle').checked;
            
            const currentConfig = {
                theme: document.getElementById('darkModeToggle').checked ? 'dark' : 'light',
                enableSearchSuggestions: document.getElementById('searchSuggestionsToggle').checked,
                showSourceSwitcher: document.getElementById('sourceSwitcherToggle').checked,
                downloadSource: document.getElementById('autoSourceToggle').checked ? 'auto' : document.getElementById('defaultSourceSelect').value,
                batchSize: parseInt(document.getElementById('batchSizeSelect').value),
                silentInstall: document.getElementById('silentInstallToggle').checked,
                enableSounds: document.getElementById('soundEffectsToggle').checked,
                installNotifications: document.getElementById('installNotificationsToggle').checked,
                autoCheckUpdates: document.getElementById('autoUpdateToggle').checked,
                categorySearchLimit: parseInt(document.getElementById('categoryLimitSelect').value),
                msstoreEnabled: msstoreEnabled,
                autoSource: document.getElementById('autoSourceToggle').checked
            };
            
            return JSON.stringify(currentConfig) !== JSON.stringify(originalConfig);
        }
        
        function openInstalledApps() {
            toggleMenu();
            window.electronAPI.openInstalledApps();
        }
        
        function showAbout() {
            toggleMenu();
            window.electronAPI.showLicense();
        }
        
        async function showSearchSuggestions(query) {
            if (!query || query.length < 1) {
                hideSearchSuggestions();
                return;
            }
            
            try {
                const suggestions = await window.electronAPI.getSearchSuggestions(query);
                const container = document.getElementById('suggestions');
                
                if (suggestions && suggestions.length > 0) {
                    let html = '';
                    suggestions.forEach(suggestion => {
                        html += `
                            <div class="suggestion-item" onclick="selectSuggestion('${suggestion.name}', '${suggestion.id}')">
                                <div class="suggestion-name">${suggestion.name}</div>
                                <div class="suggestion-id">${suggestion.id}</div>
                            </div>
                        `;
                    });
                    
                    container.innerHTML = html;
                    container.classList.add('show');
                } else {
                    hideSearchSuggestions();
                }
            } catch (error) {
                console.error('Ëé∑ÂèñÊêúÁ¥¢Âª∫ËÆÆÂ§±Ë¥•:', error);
                hideSearchSuggestions();
            }
        }
        
        function hideSearchSuggestions() {
            const container = document.getElementById('suggestions');
            container.classList.remove('show');
        }
        
        function selectSuggestion(name, id) {
            document.getElementById('searchInput').value = name;
            hideSearchSuggestions();
            search();
        }
        
        function suggestSearch(keyword) {
            document.getElementById('searchInput').value = keyword;
            search();
        }
        
        async function search() {
            const query = document.getElementById('searchInput').value.trim();
            if (!query) return;
            
            hideSearchSuggestions();
            showLoading('ÊêúÁ¥¢‰∏≠...');
            
            try {
                const apps = await window.electronAPI.searchApps(query);
                if (apps && apps.length > 0) {
                    displayApps(apps, `"${query}" ÁöÑÊêúÁ¥¢ÁªìÊûú`);
                } else {
                    showEmptyState(`"${query}" ÁöÑÊêúÁ¥¢ÁªìÊûú`, 'Êú™ÊâæÂà∞Áõ∏ÂÖ≥ËΩØ‰ª∂ÔºåÂ∞ùËØïÂÖ∂‰ªñÂÖ≥ÈîÆËØç„ÄÇ');
                }
            } catch (error) {
                console.error('ÊêúÁ¥¢Â§±Ë¥•:', error);
                showError('ÊêúÁ¥¢Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•„ÄÇ');
            }
        }
        
        async function browseCategory(category) {
            console.log('[FRONTEND] ÊµèËßàÂàÜÁ±ª:', category);
            currentCategory = category;
            
            const categoryNames = {
                'popular': 'ÁÉ≠Èó®Êé®Ëçê',
                'browser': 'ÊµèËßàÂô®',
                'dev': 'ÂºÄÂèëÂ∑•ÂÖ∑',
                'chinese': 'ÂõΩÂÜÖËΩØ‰ª∂',
                'media': 'Â™í‰ΩìÊí≠Êîæ',
                'game': 'Ê∏∏Êàè',
                'tools': 'ÂÆûÁî®Â∑•ÂÖ∑'
            };
            
            const categoryTitle = categoryNames[category] || 'ÂàÜÁ±ª';
            
            showLoading(`Âä†ËΩΩ${categoryTitle}...`);
            
            try {
                const apps = await window.electronAPI.browseCategory(category);
                console.log('[FRONTEND] ÂàÜÁ±ªÊµèËßàËøîÂõû:', apps ? apps.length : 0, '‰∏™Â∫îÁî®');
                
                if (apps && apps.length > 0) {
                    displayApps(apps, categoryTitle);
                    
                    if (category === 'popular') {
                        isPopularAppsLoaded = true;
                    }
                } else {
                    const defaultApps = getDefaultCategoryApps(category);
                    displayApps(defaultApps, categoryTitle);
                    
                    if (category === 'popular') {
                        isPopularAppsLoaded = true;
                    }
                }
            } catch (error) {
                console.error('[FRONTEND] ÂàÜÁ±ªÊµèËßàÂ§±Ë¥•:', error);
                
                const defaultApps = getDefaultCategoryApps(category);
                displayApps(defaultApps, categoryTitle);
                
                if (category === 'popular') {
                    isPopularAppsLoaded = true;
                }
            }
        }
        
        function getDefaultCategoryApps(category) {
            const categoryDefaults = {
                'popular': defaultPopularApps,
                'browser': [
                    { id: 'Microsoft.Edge', name: 'Microsoft Edge', version: 'ÊúÄÊñ∞', source: 'winget' },
                    { id: 'Google.Chrome', name: 'Google Chrome', version: 'ÊúÄÊñ∞', source: 'winget' },
                    { id: 'Mozilla.Firefox', name: 'Mozilla Firefox', version: 'ÊúÄÊñ∞', source: 'winget' }
                ],
                'dev': [
                    { id: 'Microsoft.VisualStudioCode', name: 'Visual Studio Code', version: 'ÊúÄÊñ∞', source: 'winget' },
                    { id: 'Git.Git', name: 'Git', version: 'ÊúÄÊñ∞', source: 'winget' },
                    { id: 'Python.Python.3', name: 'Python 3', version: 'ÊúÄÊñ∞', source: 'winget' }
                ],
                'chinese': [
                    { id: 'Tencent.WeChat', name: 'ÂæÆ‰ø°', version: 'ÊúÄÊñ∞', source: 'winget' },
                    { id: 'Tencent.QQ', name: 'QQ', version: 'ÊúÄÊñ∞', source: 'winget' },
                    { id: 'Baidu.BaiduNetdisk', name: 'ÁôæÂ∫¶ÁΩëÁõò', version: 'ÊúÄÊñ∞', source: 'winget' }
                ],
                'media': [
                    { id: 'VideoLAN.VLC', name: 'VLC Media Player', version: 'ÊúÄÊñ∞', source: 'winget' },
                    { id: 'Spotify.Spotify', name: 'Spotify', version: 'ÊúÄÊñ∞', source: 'winget' },
                    { id: '7zip.7zip', name: '7-Zip', version: 'ÊúÄÊñ∞', source: 'winget' }
                ],
                'game': [
                    { id: 'Valve.Steam', name: 'Steam', version: 'ÊúÄÊñ∞', source: 'winget' },
                    { id: 'EpicGames.EpicGamesLauncher', name: 'Epic Games', version: 'ÊúÄÊñ∞', source: 'winget' }
                ]
            };
            
            return categoryDefaults[category] || defaultPopularApps;
        }
        
        function displayApps(apps, title) {
            console.log('[FRONTEND] ÊòæÁ§∫Â∫îÁî®:', apps.length, '‰∏™ÔºåÊ†áÈ¢ò:', title);
            
            const contentDiv = document.getElementById('content');
            currentView = 'apps';
            
            let html = `
                <div class="apps-section">
                    <h2 class="section-title">${title}</h2>
                    <div class="metro-apps">
            `;
            
            if (!apps || apps.length === 0) {
                console.log('[FRONTEND] Â∫îÁî®ÂàóË°®‰∏∫Á©∫ÔºåÊòæÁ§∫Á©∫Áä∂ÊÄÅ');
                html += `
                    <div class="metro-empty">
                        <div class="icon">üòï</div>
                        <h2>Êú™ÊâæÂà∞ËΩØ‰ª∂</h2>
                        <p>Â∞ùËØïÂÖ∂‰ªñÂÖ≥ÈîÆËØçÊàñÂàÜÁ±ª</p>
                        <button class="metro-btn" onclick="showHomePage()" style="margin-top: 20px;">
                            ËøîÂõûÈ¶ñÈ°µ
                        </button>
                    </div>
                `;
            } else {
                console.log('[FRONTEND] ÁîüÊàêÂ∫îÁî®Âç°Áâá');
                apps.forEach(app => {
                    const isInstalling = installingApps.has(app.id);
                    const isChinaApp = app.id.includes('Tencent') || app.id.includes('Netease') || app.id.includes('Baidu');
                    const sourceText = isChinaApp ? 'ÂõΩÂÜÖCDNÂä†ÈÄü' : 'ÂÆòÊñπÊ∫ê';
                    const sourceColor = isChinaApp ? '#FF4343' : '#0078D7';
                    
                    html += `
                        <div class="metro-app-card" onclick="showAppDetail('${app.id}', '${app.name.replace(/'/g, "\\'")}', '${app.version || 'ÊúÄÊñ∞'}', '${app.source || 'winget'}')">
                            <div class="app-card-header">
                                <div class="app-card-icon">
                                    ${getAppIcon(app.name)}
                                </div>
                                <div class="app-card-title">
                                    <h3>${app.name}</h3>
                                    <div class="app-id">${app.id}</div>
                                </div>
                            </div>
                            
                            <div class="app-card-content">
                                <div class="app-meta">
                                    <span>ÁâàÊú¨: ${app.version || 'ÊúÄÊñ∞'}</span>
                                    <span style="color: ${sourceColor}">${sourceText}</span>
                                </div>
                                
                                <button class="metro-install-btn ${isInstalling ? 'installing' : ''}" 
                                        onclick="installApp('${app.id}', '${app.name.replace(/'/g, "\\'")}', event)"
                                        ${isInstalling ? 'disabled' : ''}>
                                    ${isInstalling ? 'ÂÆâË£Ö‰∏≠...' : '‰∏ÄÈîÆÂÆâË£Ö'}
                                </button>
                            </div>
                        </div>
                    `;
                });
            }
            
            html += `
                    </div>
                </div>
            `;
            
            contentDiv.innerHTML = html;
            
            const breadcrumb = document.getElementById('breadcrumb');
            if (title !== 'ÁÉ≠Èó®Êé®Ëçê') {
                breadcrumb.innerHTML = `
                    <button class="back-btn" onclick="showHomePage()">‚Üê ËøîÂõûÈ¶ñÈ°µ</button>
                `;
            } else {
                breadcrumb.innerHTML = '';
            }
            
            console.log('[FRONTEND] Â∫îÁî®ÊòæÁ§∫ÂÆåÊàê');
        }
        
        function showAppDetail(appId, appName, appVersion, appSource) {
            const contentDiv = document.getElementById('content');
            currentView = 'detail';
            
            const isChinaApp = appId.includes('Tencent') || appId.includes('Netease') || appId.includes('Baidu');
            const sourceText = isChinaApp ? 'ÂõΩÂÜÖCDNÂä†ÈÄü' : 'ÂÆòÊñπÊ∫ê';
            const sourceColor = isChinaApp ? '#FF4343' : '#0078D7';
            
            const appDescriptions = {
                'Microsoft.Edge': 'ÂæÆËΩØÊé®Âá∫ÁöÑÁé∞‰ª£ÊµèËßàÂô®ÔºåÂü∫‰∫éChromiumÂÜÖÊ†∏ÔºåÊèê‰æõÂá∫Ëâ≤ÁöÑÊÄßËÉΩÂíåÂÖºÂÆπÊÄß„ÄÇ',
                'Google.Chrome': 'Ë∞∑Ê≠åÂºÄÂèëÁöÑÂø´ÈÄü„ÄÅÂÆâÂÖ®„ÄÅÂÖçË¥πÁöÑÁΩëÈ°µÊµèËßàÂô®„ÄÇ',
                'Mozilla.Firefox': 'ÂºÄÊ∫êÁΩëÈ°µÊµèËßàÂô®ÔºåÊ≥®ÈáçÈöêÁßÅ‰øùÊä§ÂíåÂÆöÂà∂Âåñ„ÄÇ',
                'Microsoft.VisualStudioCode': 'ËΩªÈáèÁ∫ß‰ΩÜÂäüËÉΩÂº∫Â§ßÁöÑÊ∫ê‰ª£Á†ÅÁºñËæëÂô®„ÄÇ',
                'Git.Git': 'ÂàÜÂ∏ÉÂºèÁâàÊú¨ÊéßÂà∂Á≥ªÁªüÔºåÁî®‰∫éË∑üË∏™Ê∫ê‰ª£Á†ÅÊõ¥Êîπ„ÄÇ',
                'Tencent.WeChat': 'ËÖæËÆØÊé®Âá∫ÁöÑÂç≥Êó∂ÈÄöËÆØËΩØ‰ª∂ÔºåÊîØÊåÅÊñáÂ≠ó„ÄÅËØ≠Èü≥„ÄÅËßÜÈ¢ëËÅäÂ§©„ÄÇ',
                'Tencent.QQ': 'ËÖæËÆØQQÔºå‰∏≠ÂõΩÊµÅË°åÁöÑÂç≥Êó∂ÈÄöËÆØËΩØ‰ª∂„ÄÇ',
                'VideoLAN.VLC': 'ÂºÄÊ∫êÂ§öÂ™í‰ΩìÊí≠ÊîæÂô®ÔºåÊîØÊåÅÂá†‰πéÊâÄÊúâÈü≥È¢ëÂíåËßÜÈ¢ëÊ†ºÂºè„ÄÇ',
                'Valve.Steam': 'Êï∞Â≠óÂèëË°åÂπ≥Âè∞ÔºåÊèê‰æõÊ∏∏ÊàèË¥≠‰π∞„ÄÅ‰∏ãËΩΩ„ÄÅËÆ®ËÆ∫Á≠âÂäüËÉΩ„ÄÇ',
                '7zip.7zip': 'ÂÖçË¥πÂºÄÊ∫êÁöÑÂéãÁº©ËΩØ‰ª∂ÔºåÊîØÊåÅÂ§öÁßçÂéãÁº©Ê†ºÂºè„ÄÇ',
                'Spotify.Spotify': 'Èü≥‰πêÊµÅÂ™í‰ΩìÊúçÂä°Âπ≥Âè∞ÔºåÊèê‰æõÊµ∑ÈáèÈü≥‰πêËµÑÊ∫ê„ÄÇ'
            };
            
            const description = appDescriptions[appId] || `${appName} ÊòØ‰∏ÄÊ¨æ‰ºòÁßÄÁöÑÂ∫îÁî®Á®ãÂ∫èÔºåÂèØ‰ª•ÈÄöËøáPkgHub‰∏ÄÈîÆÂÆâË£Ö„ÄÇ`;
            
            contentDiv.innerHTML = `
                <button class="back-btn" onclick="showHomePage()">‚Üê ËøîÂõûÈ¶ñÈ°µ</button>
                
                <div class="app-detail-container">
                    <div class="detail-header">
                        <div class="detail-icon">
                            ${getAppIcon(appName)}
                        </div>
                        <div class="detail-title">
                            <h1>${appName}</h1>
                            <div class="app-id">${appId}</div>
                        </div>
                    </div>
                    
                    <div class="detail-meta-grid">
                        <div class="meta-item">
                            <h4>ÁâàÊú¨</h4>
                            <p>${appVersion}</p>
                        </div>
                        <div class="meta-item">
                            <h4>Êù•Ê∫ê</h4>
                            <p style="color: ${sourceColor}">${sourceText}</p>
                        </div>
                        <div class="meta-item">
                            <h4>ÂÆâË£ÖÊñπÂºè</h4>
                            <p>‰∏ÄÈîÆÈùôÈªòÂÆâË£Ö</p>
                        </div>
                        <div class="meta-item">
                            <h4>ÈÄÇÁî®Á≥ªÁªü</h4>
                            <p>Windows 7/8/10/11</p>
                        </div>
                    </div>
                    
                    <div class="detail-description">
                        <h3>Â∫îÁî®‰ªãÁªç</h3>
                        <p>${description}</p>
                    </div>
                    
                    <div class="detail-actions">
                        <button class="detail-install-btn" onclick="installApp('${appId}', '${appName.replace(/'/g, "\\'")}')">
                            Á´ãÂç≥ÂÆâË£Ö
                        </button>
                        <button class="detail-secondary-btn" onclick="searchSimilar('${appName}')">
                            Êü•ÊâæÁ±ª‰ººÂ∫îÁî®
                        </button>
                    </div>
                </div>
            `;
            
            const breadcrumb = document.getElementById('breadcrumb');
            breadcrumb.innerHTML = `
                <button class="back-btn" onclick="showHomePage()">‚Üê ËøîÂõûÈ¶ñÈ°µ</button> / 
                <button class="back-btn" onclick="browseCategory('${currentCategory || 'popular'}')" style="background: transparent; padding: 0;">
                    ${currentCategory ? 'ÂàÜÁ±ª' : 'ÁÉ≠Èó®Êé®Ëçê'}
                </button>
            `;
        }
        
        function getAppIcon(appName) {
            const icons = {
                'Chrome': 'üåê', 'Firefox': 'ü¶ä', 'Edge': 'üîµ',
                'Visual Studio': 'üíª', 'VSCode': 'üìù', 'Git': 'üì¶',
                'ÂæÆ‰ø°': 'üí¨', 'QQ': 'üêß', 'ÁΩëÊòì‰∫ëÈü≥‰πê': 'üéµ',
                'Steam': 'üéÆ', 'Spotify': 'üé∂', 'VLC': 'üì∫',
                'Python': 'üêç', 'Node.js': '‚¨¢', 'Java': '‚òï',
                '7-Zip': 'üóúÔ∏è', 'Adobe': 'üé®', 'Windows': 'ü™ü'
            };
            
            for (const [key, icon] of Object.entries(icons)) {
                if (appName.includes(key)) return icon;
            }
            
            return 'üì±';
        }
        
        async function installApp(appId, appName, event) {
            if (event) event.stopPropagation();
            
            if (installingApps.has(appId)) return;
            
            installingApps.add(appId);
            
            document.getElementById('progressContainer').classList.add('show');
            updateInstallProgress({
                appId,
                status: 'started',
                message: `ÂáÜÂ§áÂÆâË£Ö ${appName}...`
            });
            
            const buttons = document.querySelectorAll(`button[onclick*="${appId}"]`);
            buttons.forEach(btn => {
                if (btn.classList.contains('metro-install-btn') || btn.classList.contains('detail-install-btn')) {
                    btn.classList.add('installing');
                    btn.textContent = 'ÂÆâË£Ö‰∏≠...';
                    btn.disabled = true;
                }
            });
            
            try {
                const result = await window.electronAPI.installApp(appId, appName);
                
                if (result.success) {
                    setTimeout(() => {
                        installingApps.delete(appId);
                        
                        buttons.forEach(btn => {
                            if (btn.classList.contains('metro-install-btn') || btn.classList.contains('detail-install-btn')) {
                                btn.classList.remove('installing');
                                btn.classList.add('installed');
                                btn.textContent = 'Â∑≤ÂÆâË£Ö';
                                btn.disabled = true;
                            }
                        });
                        
                        setTimeout(() => {
                            document.getElementById('progressContainer').classList.remove('show');
                        }, 3000);
                        
                    }, 1000);
                } else {
                    installingApps.delete(appId);
                    
                    buttons.forEach(btn => {
                        if (btn.classList.contains('metro-install-btn') || btn.classList.contains('detail-install-btn')) {
                            btn.classList.remove('installing');
                            
                            if (result.error && (result.error.includes('ÈúÄË¶ÅÁÆ°ÁêÜÂëòÊùÉÈôê') || result.error.includes('admin') || result.error.includes('elevation'))) {
                                btn.classList.add('admin-required');
                                btn.textContent = 'ÈúÄË¶ÅÁÆ°ÁêÜÂëòÊùÉÈôê';
                                showNotification('warning', 'ÈúÄË¶ÅÁÆ°ÁêÜÂëòÊùÉÈôê', 'ËØ∑‰ª•ÁÆ°ÁêÜÂëòË∫´‰ªΩËøêË°å PkgHub');
                            } else {
                                btn.textContent = 'ÂÆâË£ÖÂ§±Ë¥•ÔºåÈáçËØï';
                            }
                            btn.disabled = false;
                        }
                    });
                    
                    setTimeout(() => {
                        document.getElementById('progressContainer').classList.remove('show');
                    }, 3000);
                    
                    showNotification('error', 'ÂÆâË£ÖÂ§±Ë¥•', result.error || 'ÂÆâË£ÖËøáÁ®ã‰∏≠Âá∫Áé∞ÈîôËØØ');
                }
            } catch (error) {
                installingApps.delete(appId);
                
                buttons.forEach(btn => {
                    if (btn.classList.contains('metro-install-btn') || btn.classList.contains('detail-install-btn')) {
                        btn.classList.remove('installing');
                        btn.textContent = 'ÂÆâË£ÖÂ§±Ë¥•ÔºåÈáçËØï';
                        btn.disabled = false;
                    }
                });
                
                setTimeout(() => {
                    document.getElementById('progressContainer').classList.remove('show');
                }, 3000);
                
                showNotification('error', 'ÂÆâË£ÖÂ§±Ë¥•', error.message || 'ÂÆâË£ÖËøáÁ®ã‰∏≠Âá∫Áé∞ÈîôËØØ');
            }
        }
        
        function searchSimilar(appName) {
            const firstWord = appName.split(' ')[0];
            document.getElementById('searchInput').value = firstWord;
            search();
        }
        
        function showHomePage() {
            currentView = 'home';
            
            console.log('[FRONTEND] ÊòæÁ§∫È¶ñÈ°µ');
            
            document.getElementById('breadcrumb').innerHTML = '';
            
            document.getElementById('content').innerHTML = `
                <div class="tiles-container">
                    <h2 class="section-title">Âø´ÈÄüÂàÜÁ±ªÊµèËßà</h2>
                    <div class="metro-grid">
                        <div class="metro-tile tile-all" onclick="browseCategory('popular')">
                            <div class="icon">üî•</div>
                            <h3>ÁÉ≠Èó®Êé®Ëçê</h3>
                            <p>Êé¢Á¥¢ÁÉ≠Èó®ËΩØ‰ª∂</p>
                        </div>
                        
                        <div class="metro-tile tile-browser" onclick="browseCategory('browser')">
                            <div class="icon">üåê</div>
                            <h3>ÊµèËßàÂô®</h3>
                            <p>Chrome, Edge, Firefox</p>
                        </div>
                        
                        <div class="metro-tile tile-dev" onclick="browseCategory('dev')">
                            <div class="icon">üíª</div>
                            <h3>ÂºÄÂèëÂ∑•ÂÖ∑</h3>
                            <p>IDE, ÁºñËæëÂô®, Â∑•ÂÖ∑</p>
                        </div>
                        
                        <div class="metro-tile tile-chinese" onclick="browseCategory('chinese')">
                            <div class="icon">üá®üá≥</div>
                            <h3>ÂõΩÂÜÖËΩØ‰ª∂</h3>
                            <p>ÂæÆ‰ø°, QQ, ÁΩëÊòì‰∫ë</p>
                        </div>
                        
                        <div class="metro-tile tile-media" onclick="browseCategory('media')">
                            <div class="icon">üéµ</div>
                            <h3>Â™í‰ΩìÊí≠Êîæ</h3>
                            <p>Èü≥‰πê, ËßÜÈ¢ë, Êí≠ÊîæÂô®</p>
                        </div>
                        
                        <div class="metro-tile tile-game" onclick="browseCategory('game')">
                            <div class="icon">üéÆ</div>
                            <h3>Ê∏∏Êàè</h3>
                            <p>Steam, Ê∏∏ÊàèÂπ≥Âè∞</p>
                        </div>
                    </div>
                </div>
                
                <div class="apps-section">
                    <h2 class="section-title" id="appsTitle">Ê¨¢Ëøé‰ΩøÁî® PkgHub</h2>
                    <div class="metro-apps" id="results">
                        <div class="metro-empty">
                            <div class="icon">üöÄ</div>
                            <h2>ÂºÄÂßãÊé¢Á¥¢</h2>
                            <p>ÈÄâÊã©‰∏Ä‰∏™ÂàÜÁ±ªÊàñÊêúÁ¥¢ËΩØ‰ª∂Êù•ÂºÄÂßã</p>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function updateInstallProgress(data) {
            const title = document.getElementById('progressTitle');
            const status = document.getElementById('progressStatus');
            const fill = document.getElementById('progressFill');
            const message = document.getElementById('progressMessage');
            
            switch(data.status) {
                case 'started':
                    title.textContent = `Ê≠£Âú®ÂÆâË£Ö ${data.appId}`;
                    status.textContent = '0%';
                    fill.style.width = '0%';
                    message.textContent = data.message || 'Ê≠£Âú®ÂáÜÂ§á...';
                    break;
                    
                case 'completed':
                    title.textContent = `ÂÆâË£ÖÂÆåÊàê: ${data.appId}`;
                    status.textContent = '100%';
                    fill.style.width = '100%';
                    message.textContent = '‚úÖ ÂÆâË£ÖÊàêÂäüÔºÅ';
                    break;
                    
                case 'failed':
                    title.textContent = `ÂÆâË£ÖÂ§±Ë¥•: ${data.appId}`;
                    message.textContent = '‚ùå ' + (data.message || 'ÂÆâË£ÖÂ§±Ë¥•');
                    fill.style.background = '#FF4343';
                    break;
            }
        }
        
        function showLoading(message = 'Âä†ËΩΩ‰∏≠...') {
            const contentDiv = document.getElementById('content');
            contentDiv.innerHTML = `
                <div class="metro-empty">
                    <div class="icon" style="font-size: 48px; animation: spin 1s linear infinite;">üîÑ</div>
                    <h2>${message}</h2>
                    <p>ËØ∑Á®çÂÄô...</p>
                </div>
            `;
        }
        
        function showEmptyState(title, message) {
            const contentDiv = document.getElementById('content');
            contentDiv.innerHTML = `
                <div class="apps-section">
                    <h2 class="section-title">${title}</h2>
                    <div class="metro-apps">
                        <div class="metro-empty">
                            <div class="icon">üòï</div>
                            <h2>${message}</h2>
                            <button class="metro-btn" onclick="showHomePage()" style="margin-top: 20px;">
                                ËøîÂõûÈ¶ñÈ°µ
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }
        
        function showError(errorMessage) {
            console.error('ÂâçÁ´ØÈîôËØØ:', errorMessage);
        }
    </script>
</body>
</html>
